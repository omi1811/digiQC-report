{% extends 'base.html' %}
{% block title %}Instruction Activity Summary{% endblock %}
{% block content %}
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h3 class="mb-0"><i class="bi bi-diagram-3 me-2 text-warning"></i>Instruction Activity Summary</h3>
    <a href="{{ url_for('reports_page') }}" class="btn btn-outline-secondary btn-sm"><i class="bi bi-arrow-left"></i> Reports</a>
  </div>
  <div class="card">
    <div class="card-body">
      <p>This integrates outputs from the <code>digiqc_Inst</code> folder (COMBINED.csv + Pred_*.csv).</p>
      <div class="d-grid gap-2 d-md-flex">
        <a class="btn btn-warning" href="{{ url_for('inst_summary_build') }}"><i class="bi bi-gear"></i> Rebuild Summary</a>
        <a class="btn btn-outline-primary{% if not exists.csv %} disabled{% endif %}" href="{{ url_for('inst_summary_download_csv') }}"><i class="bi bi-download"></i> Download CSV</a>
        <a class="btn btn-outline-success{% if not exists.xlsx %} disabled{% endif %}" href="{{ url_for('inst_summary_download_xlsx') }}"><i class="bi bi-download"></i> Download XLSX</a>
      </div>
      <hr>
      <ul class="list-unstyled small text-muted">
        <li>COMBINED.csv present: <strong>{{ 'Yes' if exists.combined else 'No' }}</strong></li>
        <li>Combined_Summary.csv present: <strong>{{ 'Yes' if exists.csv else 'No' }}</strong></li>
        <li>Combined_Summary.xlsx present: <strong>{{ 'Yes' if exists.xlsx else 'No' }}</strong></li>
      </ul>
      <p class="small text-muted">To regenerate Excel output, install <code>xlsxwriter</code> in your environment.</p>
    </div>
  </div>
{% endblock %}
